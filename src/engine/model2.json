{
  "eq": "/*\nThis file was generated by Myokit.\n\ndesc: Voltage clamp model with standard compensation [1].\n\n[1] Accounting for variability in ion current recordings using a\n    mathematical model of artefacts in voltage-clamp experiments.\n    Chon Lok Lei, Michael Clerx, Dominic G. Whittaker, David J. Gavaghan,\n    Teun P. de Boer, Gary R. Mirams.\n    Phil. Trans. R. Soc. A, 378: 20190348, 2020.\n    https://doi.org/10.1098/rsta.2019.0348\ndisplay_name: Lei et al., 2020 Voltage clamp model adapted for API\nmmt_authors: Chon Lok Lei\nname: voltage_clamp_model_api_ikr\nversion: 20230221\n\n*/\n\n/* Input parameters */\nin = [ ]\n\n/* Engine: pace */\n/* E.g. { -80 + 120*heaviside(t-10) - 80*heaviside(t-20) } */\nenginePace { 0.0 * 1.0 } /* engine.pace */\n\n/* Constants: cell */\ncellCm { 20.0 } /* cell.Cm [pF] */\n\n/* Constants: extra */\nextraKo { 5.4 } /* extra.Ko [mM] */\nextraNao { 140.0 } /* extra.Nao [mM] */\n\n/* Constants: ki */\nkiKi { 130.0 } /* ki.Ki [mM] */\n\n/* Constants: nai */\nnaiNai { 10.0 } /* nai.Nai [mM] */\n\n/* Constants: phys */\nphysF { 9.64853415000000041e+01 } /* phys.F [C/mmol] */\nphysR { 8.314472 } /* phys.R [J/mol/K] */\nphysT { 310.0 } /* phys.T [K] */\nphysRTF { physR * physT / physF } /* phys.RTF [mV] */\n\n/* Constants: erev */\nerevEK { physRTF * log(extraKo / kiKi) } /* erev.E_K [mV] */\nerevENa { physRTF * log(extraNao / naiNai) } /* erev.E_Na [mV] */\n\n/* Constants: voltage_clamp */\nvoltageClampCPrs { 0.0 } /* voltage_clamp.C_prs [pF] */\nvoltageClampCPrsEst { 4.0 } /* voltage_clamp.C_prs_est [pF] */\nvoltageClampCmEst { 25.0 } /* voltage_clamp.Cm_est [pF] */\nvoltageClampELeak { -80.0 } /* voltage_clamp.E_leak [mV] */\nvoltageClampELeakEst { -80.0 } /* voltage_clamp.E_leak_est [mV] */\nvoltageClampRSealMOhm { 500.0 } /* voltage_clamp.R_seal_MOhm [MOhm] */\nvoltageClampRSealEstMOhm { 1000.0 } /* voltage_clamp.R_seal_est_MOhm [MOhm] */\nvoltageClampRSeriesMOhm { 30.0 } /* voltage_clamp.R_series_MOhm [MOhm] */\nvoltageClampRSeriesEstMOhm { 25.0 } /* voltage_clamp.R_series_est_MOhm [MOhm] */\nvoltageClampVOffsetEff { -1.0 } /* voltage_clamp.V_offset_eff [mV] */\nvoltageClampAlphaPPercentage { 0.0 } /* voltage_clamp.alpha_P_percentage */\nvoltageClampAlphaRPercentage { 0.0 } /* voltage_clamp.alpha_R_percentage */\nvoltageClampTauClamp { 0.0008 } /* voltage_clamp.tau_clamp [ms] */\nvoltageClampTauOut { 0.0075 } /* voltage_clamp.tau_out [ms] */\nvoltageClampTauRs { 0.1 } /* voltage_clamp.tau_rs [ms] */\nvoltageClampTauSum { 0.07 } /* voltage_clamp.tau_sum [ms] */\nvoltageClampRSeries { voltageClampRSeriesMOhm * 0.001 } /* voltage_clamp.R_series [GOhm] */\nvoltageClampRSeriesEst { voltageClampRSeriesEstMOhm * 0.001 } /* voltage_clamp.R_series_est [GOhm] */\nvoltageClampAlphaP { voltageClampAlphaPPercentage / 100.0 } /* voltage_clamp.alpha_P */\nvoltageClampAlphaR { voltageClampAlphaRPercentage / 100.0 } /* voltage_clamp.alpha_R */\nvoltageClampGLeak { 1.0 / (voltageClampRSealMOhm * 0.001) } /* voltage_clamp.g_leak [nS] */\nvoltageClampGLeakEst { (0.0 * (1 - heaviside(voltageClampRSealEstMOhm - 1e-06)) + 1.0 / (voltageClampRSealEstMOhm * 0.001) * heaviside(voltageClampRSealEstMOhm - 1e-06)) } /* voltage_clamp.g_leak_est [nS] */\n\n/* Constants: ikr */\nikrP1 { 2.06469371000000002e-03 } /* ikr.p1 [mS/uF] */\nikrP2 { 7.17061645999999969e-02 } /* ikr.p2 [1/mV] */\nikrP3 { 3.44186256999999990e-05 } /* ikr.p3 [mS/uF] */\nikrP4 { 6.17661788000000017e-02 } /* ikr.p4 [1/mV] */\nikrP5 { 4.17809103000000015e-01 } /* ikr.p5 [mS/uF] */\nikrP6 { 2.57733544000000002e-02 } /* ikr.p6 [1/mV] */\nikrP7 { 4.75152440999999995e-02 } /* ikr.p7 [mS/uF] */\nikrP8 { 2.50856877999999991e-02 } /* ikr.p8 [1/mV] */\nikrP9 { 0.1524 } /* ikr.p9 [uS] */\n\n/* Initial conditions */\nu_i {\n  membraneV = -80, /* membrane.V [mV] */\n  ikrI = 0, /* ikr.I [1] */\n  ikrCI = 0, /* ikr.CI [1] */\n  ikrO = 0, /* ikr.O [1] */\n  ikrIi = 0, /* ikr.Ii [1] */\n  ikrCIi = 0, /* ikr.CIi [1] */\n  ikrOi = 0, /* ikr.Oi [1] */\n  voltageClampVClamp = -80, /* voltage_clamp.V_clamp [mV] */\n  voltageClampVP = -80, /* voltage_clamp.V_p [mV] */\n  voltageClampVEst = -80, /* voltage_clamp.V_est [mV] */\n  voltageClampIOut = 0, /* voltage_clamp.I_out [pA] */\n  voltageClampIInP = 0, /* voltage_clamp.I_in_p [pA] */\n}\n\ndudt_i {\n  diffMembraneV = 0,\n  diffIkrI = 0,\n  diffIkrCI = 0,\n  diffIkrO = 0,\n  diffIkrIi = 0,\n  diffIkrCIi = 0,\n  diffIkrOi = 0,\n  diffVoltageClampVClamp = 0,\n  diffVoltageClampVP = 0,\n  diffVoltageClampVEst = 0,\n  diffVoltageClampIOut = 0,\n  diffVoltageClampIInP = 0,\n}\n\n/* Variables: ideal */\nidealVC { enginePace * 1.0 } /* ideal.V_c */\n\n/* Variables: voltage_clamp */\nvoltageClampIOutPA { voltageClampIOut * cellCm } /* voltage_clamp.I_out_pA [pA] */\nvoltageClampVC { enginePace * 1.0 } /* voltage_clamp.V_c [mV] */\nvoltageClampDotVP { (voltageClampVClamp - voltageClampVP) / voltageClampTauClamp } /* voltage_clamp.dot_V_p [A/F] */\nvoltageClampILeak { voltageClampGLeak * (membraneV - voltageClampELeak) } /* voltage_clamp.I_leak [pA] */\nvoltageClampIPost { voltageClampIOut - voltageClampGLeakEst * (voltageClampVC - voltageClampELeakEst) / cellCm } /* voltage_clamp.I_post [A/F] */\nvoltageClampDotVEst { (0.0 * (1 - heaviside(voltageClampCmEst - 1e-06) * heaviside(voltageClampRSeriesEst - 1e-06)) + (voltageClampVC - voltageClampVEst) / ((1.0 - voltageClampAlphaP) * voltageClampCmEst * voltageClampRSeriesEst) * heaviside(voltageClampCmEst - 1e-06) * heaviside(voltageClampRSeriesEst - 1e-06)) } /* voltage_clamp.dot_V_est [A/F] */\nvoltageClampIPostPA { voltageClampIPost * cellCm } /* voltage_clamp.I_post_pA [pA] */\nvoltageClampDotVClamp { (voltageClampVC + (voltageClampIInP * cellCm * voltageClampAlphaR + voltageClampCmEst * voltageClampDotVEst * voltageClampAlphaP) * voltageClampRSeriesEst - voltageClampVClamp) / voltageClampTauSum } /* voltage_clamp.dot_V_clamp [A/F] */\nvoltageClampIIn { ((voltageClampVP - membraneV + voltageClampVOffsetEff) / voltageClampRSeries + voltageClampCPrs * voltageClampDotVP - voltageClampCPrsEst * voltageClampDotVClamp - voltageClampCmEst * voltageClampDotVEst) / cellCm } /* voltage_clamp.I_in [A/F] */\n\n/* Variables: ikr */\nikrC { 1.0 - ikrCI - ikrI - ikrO } /* ikr.C [1] */\nikrCi { 1.0 - ikrCIi - ikrIi - ikrOi } /* ikr.Ci [1] */\nikrIKr { ikrP9 * ikrO * (membraneV - erevEK) * 50.0 } /* ikr.IKr [A/F] */\nikrIKrI { ikrP9 * ikrOi * (idealVC - erevEK) } /* ikr.IKr_i [nA] */\nikrK12 { ikrP1 * exp(ikrP2 * membraneV) } /* ikr.k12 [mS/uF] */\nikrK12I { ikrP1 * exp(ikrP2 * idealVC) } /* ikr.k12i [mS/uF] */\nikrK14 { ikrP7 * exp(-ikrP8 * membraneV) } /* ikr.k14 [mS/uF] */\nikrK14I { ikrP7 * exp(-ikrP8 * idealVC) } /* ikr.k14i [mS/uF] */\nikrK21 { ikrP3 * exp(-ikrP4 * membraneV) } /* ikr.k21 [mS/uF] */\nikrK21I { ikrP3 * exp(-ikrP4 * idealVC) } /* ikr.k21i [mS/uF] */\nikrK41 { ikrP5 * exp(ikrP6 * membraneV) } /* ikr.k41 [mS/uF] */\nikrK41I { ikrP5 * exp(ikrP6 * idealVC) } /* ikr.k41i [mS/uF] */\n\n/* Variables: membrane */\nmembraneIIdeal { ikrIKrI } /* membrane.I_ideal [pA] */\nmembraneIIon { ikrIKr / 50.0 } /* membrane.I_ion [pA] */\n\n/* Solve */\nF_i {\n  diffMembraneV,\n  diffIkrI,\n  diffIkrCI,\n  diffIkrO,\n  diffIkrIi,\n  diffIkrCIi,\n  diffIkrOi,\n  diffVoltageClampVClamp,\n  diffVoltageClampVP,\n  diffVoltageClampVEst,\n  diffVoltageClampIOut,\n  diffVoltageClampIInP,\n}\n\nG_i {\n  (voltageClampVP + voltageClampVOffsetEff - membraneV) / (cellCm * voltageClampRSeries) - (membraneIIon + voltageClampILeak) / cellCm,\n  -ikrK14 * ikrI + ikrK41 * ikrO + ikrK12 * ikrCI - ikrK21 * ikrI,\n  -ikrK12 * ikrCI + ikrK21 * ikrI + ikrK41 * ikrC - ikrK14 * ikrCI,\n  -ikrK21 * ikrO + ikrK12 * ikrC + ikrK14 * ikrI - ikrK41 * ikrO,\n  -ikrK14I * ikrIi + ikrK41I * ikrOi + ikrK12I * ikrCIi - ikrK21I * ikrIi,\n  -ikrK12I * ikrCIi + ikrK21I * ikrIi + ikrK41I * ikrCi - ikrK14I * ikrCIi,\n  -ikrK21I * ikrOi + ikrK12I * ikrCi + ikrK14I * ikrIi - ikrK41I * ikrOi,\n  voltageClampDotVClamp,\n  voltageClampDotVP,\n  voltageClampDotVEst,\n  (voltageClampIIn - voltageClampIOut) / voltageClampTauOut,\n  (voltageClampIIn - voltageClampIInP) / voltageClampTauRs,\n}\n\n/* Output */\nout_i {\n  ikrCI,\n  ikrCIi,\n  ikrI,\n  ikrIi,\n  ikrIKr,\n  ikrO,\n  ikrOi,\n  membraneV,\n  voltageClampIInP,\n  voltageClampIOut,\n  voltageClampVClamp,\n  voltageClampVEst,\n  voltageClampVP,\n}"
}
